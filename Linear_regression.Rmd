---
title: "Linear_regression"
author: "Felix Tran"
date: "December 2, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(modelr)
library(mgcv)
library(purrr)
library(readr)
```

```{r}
poverty_df <- readr::read_csv('./Data/pm_and_poverty_09-13.csv') %>% 
  janitor::clean_names() %>% 
  filter(str_detect(geo_type_name, "UHF") == T) %>% 
  filter(measure == "Percent") %>%
  filter(name == "Poverty") %>% 
  mutate(geography_id = as.integer(geo_entity_id)) %>% 
  rename(poverty_rate = data_value) %>% 
  select(geography_id, poverty_rate)

pm_df <- readr::read_csv('./Data/pm_and_poverty_09-13.csv') %>% 
  janitor::clean_names() %>% 
  filter(str_detect(geo_type_name, "UHF") == T) %>% 
  filter(measure == "Mean") %>%
  filter(str_detect(name, "PM") == T) %>% 
  mutate(geography_id = as.integer(geo_entity_id)) %>% 
  group_by(geography_id) %>% 
  summarize(pm_level = round(mean(data_value), digits = 1))

asthma_df <- readr::read_csv('./Data/nyc_asthma_cleaned.csv') %>% 
  janitor::clean_names() %>% 
  filter(str_detect(geo_type_name, "UHF") == T) %>% 
  filter(str_detect(name, "PM2.5-Attributable") == T) %>% 
  rename(geography_id = geo_entity_id) %>% 
  inner_join(., poverty_df, pm_df, by = "geography_id")
```

